Введение
Создание диалоговой партнерской системы состоит из нескольких этапов.
Определив круг проблем и вопросов, которые могут помочь принять решение, с помощью текстового редактора описываются вопросы, которые необходимо задать.
Затем в этот текстовый файл вносятся ключевые слова и метки, превращающие его в описание сценария диалога на языке QST.
Сценарий диалога на языке QST обрабатывается QST транслятором и помещается в базу знаний.
После этого вызывается диалоговый интерфейсный модуль, позволяющий пользователю системы вводить данные по описанному сценарию.
Для получения вывода на основе введенных данных должны быть описаны связи и взаимоотношения между данными, полученными с помощью нашего сценария.
Эти взаимосвязи описываются в виде синдромов на языке SYND, и с помощью SYND транслятора тоже помещаются в базу знаний.
Полученные выводы пользователь также может наблюдать с помощью диалогового интерфейсного модуля.
В этом документе приведено описание языка QST, а также некоторые возможности и команды транслятора QST.
Транслятор QST. Создание сценария диалога.
Язык QST предназначен для описания сценария диалога. 
Диалог состоит из вопросов к пользователю системы, которые могут быть определенным образом структурированы и дополнены картинками и подсказками.
Описание языка QST представлено в данном документе на примерах.
Текст
Если необходимо указать текст вопроса, то при его вводе необходимо отступить несколько пробелов от начала строки.
В языке QST положение слова в строке определяет его значение. С начала строки указываются управляющие команды, которые не выводятся на экран во время диалога с пользователем.
Также в тексте не должны встречаться слова, которые могут быть приняты транслятором за ключевые. Например, *** в тексте будет принято за определение поля ввода трехзначного числа. 
Для вызова примера - нажмите левую кнопку мыши на ссылке. Будет запущен транслятор QST и показана краткая инструкция по его использованию.
Вызов транслятора. Текст.
Поле ввода вопроса
Поля ввода могут быть заданы следующими ключевыми метками:
...
Текстовый вопрос. В данном месте пользователю будет предложено ввести некоторый текст. Ширина поля ввода ограничена справа текстом (если он есть) или 64-й позицией от начала строки.
*
Бинарный вопрос. Ответ может быть ?да?, ?нет? или ?неизвестно?.
***
Поле ввода числа. Количество звездочек ограничивает количество знаков числа.
***.**
Поле ввода дробного числа. Количество звездочек ограничивает количество знаков до и после запятой.
*
Поле ввода со списком, предваряемое списком значений.
При вводе числа можно указать границы (min-max), указав их перед полем ввода:
    Год рождения: (1900-2100)  ****

    (35-40) Температура: **.*
Вопрос 
Вопросом мы будем называть поле ввода вопроса с предшествующим ему текстом вопроса. 
Во время диалога отдельные вопросы будут оттеняться цветом, если навести на них мышь. Для выбора вопроса надо щелкнуть на нем мышью.
Поле ввода со списком
Поле ввода со списком обозначается так же, как и бинарное поле ввода, но перед ним указывается список значений с цифровыми ключами:
    Пол: муж -1 жен -2  *  
Список значений отделяется от текста знаком ':'.
Вызовите пример. Из транслятора вызовите диалоговый интерфейс, нажав <F10>.
Пример 1 Поля ввода.
Краткое имя
Краткое имя для поля ввода задается в конце строки, содержащей поле ввода.
    Год рождения: ****   Year
Если в строке присутствуют несколько полей ввода, то их краткие метки указываются в конце строки, через запятую, без пробелов.
    Введите числа: a = ***  b = *** с = ***   a,b,c 
Ссылки
Если в тексте указан ключевой символ &, а в конце строки указано краткое имя поля ввода, то вместо & отобразится значение, введенное пользователем в это поле ввода.
Ссылка на поле ввода предназначена для вывода на экран введенного ранее значения. 1
Она задается символом &, после которого указывается краткое имя определенного выше поля ввода. Правила задания кратких меток одинаковы для ссылок и полей ввода.
    Ваш год рождения: &     Year
    Вы ввели:  a: &     b: &    c: &    a,b,c
Пример 2 Ссылки.
Раздел
Текст и вопросы объединяются в разделы. 
Для определения раздела необходимо поставить одноименные метки вначале и в конце раздела, причем открывающая метка раздела пишется с круглыми скобками.
Метки раздела, в отличие от простого текста, всегда указываются с начала строки.
Sec()
      *  K
Sec   *  L

Последней строкой раздела является строка, в которой находится закрывающая метка. Поэтому поле L тоже попадает в раздел Sec. 2
Условие обхода
Часто бывает необходимо в зависимости от ситуации или задавать некоторые уточняющие вопросы, или их пропускать. 
Например, если не проводилось исследование, то не нужно задавать вопросы о его результатах. Это описывается так:
Иссл(0) 
    Исследование проводилось: *
    Результат исследования: положительный -1 отрицательный -2 *
    Назначено дополнительное исследование *
    ...
Иссл

В скобках метки раздела указывается условие обхода. Оно относится к первому вопросу в разделе.
Если условие выполнено (в нашем примере - дан отрицательный ответ, т.е. 0), то не будут задаваться остальные вопросы раздела.
В условии обхода можно указывать промежуток значений или перечислять значения.
Условие обхода может обуславливаться переменными, заданными раньше3 (этот случай называется ?отложенное управление?), например:
    Введите цифру: (0-9) * num
Odd(num=0,2,4,6,8)
    Нечетная цифра.
Odd
Small(num>=5)
    Меньше пяти.
Small
Если условие обхода выполнено, то раздел не раскрывается и его содержимое не показывается. 4
Пример 3 Условия обхода.
Заголовок раздела
Заголовок раздела оттеняется особым цветом в диалоговом интерфейсе. 
Заголовком является: 
Если есть условие обхода - первый вопрос раздела.
Если нет условия обхода, или есть отложенное управление:
первая строка раздела, после открывающей метки со скобками;
строка раздела, следующая за заголовком, если в начале ее есть символ '\'.
Заголовок отображается всегда, даже если раздел закрыт (выполнено условие обхода раздела). 
Рассмотрим следующий пример:
	Пример 4 Заголовки.
Вопросы группируются в разделы со своими заголовками, которые оттеняются цветом, в результате чего мы получаем удобное визуальное представление информации. 
Рисунки и звуки
Для подключения файла, в котором находится рисунок или звук, необходимо вставить в текст ключевое слово @[имя_файла], где имя_файла - путь и имя файла.5 Например:
   На этом рисунке вы видите: @[..\pic\sign.bmp]
Текущая версия диалогового интерфейса поддерживает графические файлы BMP, GIF, JPG.
Таким же образом можно указывать звуковые файлы формата WAV. Звуки проигрываются при нажатии на них мышкой.
Пример 5 Рисунки
Ключи  раздела
Ключевые признаки - это вопросы, по значению которых можно идентифицировать конкретную запись в базе данных. Например, это номер карты больного. Ключи задаются в скобках открывающей метки раздела, после знака @.
    **** No
BolSec(@No)
    Вопросы и подразделы, относящиеся к больному No
BolSec

Условие обхода такого раздела может быть указано до знака @.
Ключевых признаков может быть несколько. 6 
Если необходимо обратиться к ключу из раздела, то необходимо явно задать имя ключа:
     *** No
S(@Key=No)
   Ключевое поле = & Key
S
При вводе данных в раздел для каждого значения ключа создается свой набор данных.
Пример 6 Ключи раздела
Вызов раздела
Раздел, в котором описан ключ, можно вызвать повторно, указав ему другое подходящее значение ключа.7  
Для этого указывается имя раздела в начале строки, перед которым ставится знак '^':
   *** NewKey
^S(@NewKey)
Это полезно, когда хочется одновременно вводить данные по одному сценарию для нескольких однородных объектов.
В качестве ключевого поля указывается другое поле того же типа, что и при определении вызываемого раздела. 
Пример 7 Вызов раздела
Описание раздела
Иногда бывает необходимо сначала описать раздел, не отображая его, а потом вызвать его, задав значение ключевого поля. Для этого раздел описывается, и указывается только тип ключевого поля для этого раздела. 
%DefSec(@keyfield=целое)
    ... содержание раздела ...
%DefSec
Такой раздел не будет показан в месте своего определения, а только в месте вызова.
Правым операндом в определении ключевого поля при описании раздела является тип ключевого поля. Тип может принимать следующие значения:
'Целое' или '*' -  Целое число, бинарное поле или список значений;
'Дробное' или '*.*' - Дробное число;
'Строка' или '...' - Текстовая строка.
Возможно описание раздела без задания ключевого поля. Такой раздел нельзя будет вызвать, но можно будет использовать как справку.
Подключение файла QST
Для того, чтобы в текущей позиции вставить содержимое другого QST файла, необходимо с начала строки поставить ключевое слово:
<имя_файла.qst>
Большие вопросники бывает удобно разбить на несколько небольших файлов.
 Например, можно вынести из основного текста справки с рисунками, а можно составлять различные по составу вопросники, собирая их из небольших файлов - ?кирпичиков?. 

Пример 8 Подключение файла QST
Синтез текста и вызов транслятора SYND
На основании ответов пользователя система может делать определенные выводы и генерировать текст. Для этого, в текстовом файле с расширением .CNC описываются синдромы на языке SYND. Для вызова транслятора SYND и генерации текста необходимо после описания сценария ввода данных указать с начала строки:
<имя_файла.cnc>    краткое_имя
После этого система вызовет транслятор SYND, который, пользуясь правилами, описанными в указанном файле, сгенерирует текст вывода, на основании введенных пользователем данных. 
Вывести на экран эти данные возможно указав ссылку на приведенное краткое имя.
Подключение файла HLP
В рамках совместимости со старыми версиями системы возможно задавать подсказки в отдельном .HLP файле. Формат HLP файла:
краткое_имя
    Текст справки (многострочный)
краткое_имя
    Текст справки
Сформированный таким образом файл может быть подключен после описания полей ввода с такими именами. Для этого с начала строки указывается:
<имя_файла.hlp>
Но в таком виде можно задавать только текстовые подсказки, без рисунков.
Справка
Для того, чтобы сформировать подсказку к некоторому понятию или разделу, необходимо оформить текст в виде описания раздела. В этом разделе могут быть указаны рисунки.
Как связать ?справочный раздел? с понятием - описано в главе ?Параметры?.
Справка будет доступна в диалоговом интерфейсе при нажатии на значок ?, возникающий слева от полей ввода и в заголовке тех разделов, что имеют справки.
Параметры
С помощью ?параметров? возможно дополнительно настроить некоторые детали представления информации. 
Параметры задаются с начала строки, в фигурных скобках, в формате имя=значение.8 Несколько параметров указываются через запятую.
Поддерживаются параметры: 
1)Справка, Ширина, Высота, %Ширины, %Высоты;
2)Файл, Список;
3)Начало, Конец, Применить. 9
Параметр ?Справка? предназначен для задания подсказки вопросам и разделам. Значение может быть задано строкой текста или именем описанного выше раздела. Например:
{Справка=Это поле ввода числа}
{Справка=HelpSec}
Такая справка будет связана со следующим за этой строкой объектом - вопросом или разделом.
Для увеличения области действия надо указать модификаторы  ?Начало? и ?Конец?:
{Справка="Подсказка для группы вопросов",Начало} 10
?   ? группа вопросов и разделов ? 
{Справка,конец}
Такая справка будет распространяться на все вопросы и разделы между ?началом? и ?концом?.11
Модификаторы ?начало? и ?конец? применимы только к параметрам первой группы.
Они действуют на все параметры, приведенные вместе с ними в одной строке. 
Модификатор ?Применить? определяет область действия параметра указанным здесь же кратким именем:
{Справка=Help1,Применить=Field1}
{Справка=Help2,Применить=Section1}
Он применим к параметрам первой группы и к параметру ?Файл?.
Пример 9 Справка
Модификаторы 3-й группы не применимы к параметру ?Список?:
{Список=Нет}	- отключает разбор элементов списка, поле ввода со списком превращается в поле вода числа.
{Список=Да} 	- включает обратно преобразование элементов в выпадающий список.
Параметр ?Список? действует на все поля ввода со списком, указанные после. Вместо ?да? может быть указано ?0?, вместо ?нет? - ?1?.
Параметр ?Файл? применим только к полям ввода строки и превращает такие поля в диалог выбора имени файла:
{Файл,Справка=Здесь откроется диалог выбора файла!}
        Поле выбора имени файла  ...  FileName1
Или так:
{Файл,Применить=FileName1}

Значение в параметрах ?Ширина? и ?Высота? - размер окна для раздела.
Значение в параметрах ?%Ширины? и ?%Высоты? - число от 0 до 100, задающее автоматический размер окна для раздела с последующим скроллингом.
Эти параметры применимы к разделам.
Пример. Параметры
Комментарии
Для того, чтобы закомментировать строку, надо в первой позиции строки поставить символ '|'.
Кусок текста
Возможно пометить кусок как содержащий только текст, без каких-либо управляющих символов. Это удобно, если встречается большой кусок текста или хочется использовать в тексте символы, зарезервированные под ключевые в QST.
Для этого в первой позиции строки перед текстом надо указать символ '[', а в первой позиции строки после окончания куска текста - символ ']'.
Автоматические краткие имена 
Каждому полю ввода присваивается некоторое краткое имя. Если краткое имя не задано явно, то оно генерируется автоматически и составляется из имени текущего раздела и порядкового номера среди безымянных вопросов:
Sec()
    *
    *  Num
Sec *
В данном примере вопросы имеют имена Sec_1, Num и Sec_2.
Для совместимости со старыми вопросниками допускается задавать одну метку для нескольких вопросов в строке. Краткие имена тогда генерируются путем прибавления номера после знака '/' :
    *   *   *  aw
Вопросы имеют имена aw/1, aw/2 и aw/3. 
В новых вопросниках рекомендуется явно задавать краткие имена.
Ограничения
Краткие имена не могут совпадать, без различия регистра символов.
Краткое имя не должно быть длиннее 12 символов.
Имя раздела не может совпадать с именем файла вопросника.
Имя раздела не может совпадать с именем поля ввода.
Условие раскрытия не может содержать пробелы.
Звуки должны попадать в вопрос.
Ссылки и отложенное управление должны находиться в том же разделе, если нет ключа.
В отложенном управлении имя метки должно идти сначала сравнения.
Ключевое поле должно быть задано в родительском разделе или в заголовке раздела.

Таблицы
Команды меню транслятора
Конфигурационный файл
Кнопка
Выполняемый файл